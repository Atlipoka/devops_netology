1. Распишу по пунктам:
  * Для поиска проблемной операции можно использовать db.currentOp() и потом остановить операцию db.killOp()
  * Устранять проблемные операции следует начать с мониторинга db.enableFreeMonitoring(), так можно отслежить поведение системы и понимать что в какой момент времени были проблемы. Методом explain проверить проблемные запросы и принять решение, что сделать для оптимизации, переписать запрос или построить индексы.
2. Ознакомившись с документацией Redis нашел пункт, в котором говориться про большое кол-во истекающих ключей. Есть механизм, который 10 раз в секунду проверяет актуальность ключей и если в одну секунду кол-во истекающих записей превышает 25%, то редис может заблокироваться до того момента, пока процент истекших не станет равен 20%. Поэтому не рекомендуется хранить большое кол-во записей ключей истекающих в одно время.
3. Ошибка ``InterfaceError: (InterfaceError) 2013: Lost connection to MySQL server during query`` говорит о том, что есть сетевые проблемы. В нашем случае проблемы в том, что запрос не успевает выполниться в отпределенное время и падает по таймауту. Необходимо проверить настройки таймаута и попробовать увеличить для проверки. Я не вижу серьезного решения проблемы увеличением таймаута, необходимо системно подходить к решению проблемы. Необходимо анализировать все проблемные запросы и принимать решение что сдлеать сначала, может переписать запрос, может использовать индексы, может оба варианта сразу.
4. oom-killer - это инструмент семейства Linux, которое завершает процессы которые приводят к утечке памяти. Он имеет свои особенности определения процесса, который необходимо завершить, но в целом, если проблема возникла, это говорит о нехватке ресурсов. В первую очередь, следует провести анализ потребления ресурсов на сервере и понять, нет ли парралельных ненужных процессов, которые могут потреблять память и решить, чем можно пожертвовать. Так-же, посмотреть в сторону работы БД, проанализировать запросы, посмотртеь что может влиять на долгую работу внутри БД, может есть большие и громоздкие запросы, нехвататет индексов и т.д. Ну и в целом, посмотреть в сторону увеличения ресурсов сервера, всегда необходимо иметь небольшой запас ресурсов ОП и ЦП.
